<link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/ispeak@4.4.0/style.css"
/>
<script src="https://cdn.staticfile.org/highlight.js/10.6.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.org/marked/2.0.0/marked.min.js"></script>
<script src="https://gcore.jsdelivr.net/gh/cayzlh/psychic-potato@master/js/ispeak.js"></script>

<article class='md-text content <%- page.layout %><%- scrollreveal() %>'
         style="padding-top: 0;padding-left: 1rem;padding-right: 1rem;padding-bottom: 1rem;" id='sp'>
    <%- page.content %>
    <div id="tip" style="text-align:center;">加载中...</div>
    <div id="ispeak"></div>
</article>
<%- partial('_partial/plugins/comments/layout') %>

<script>
    var head = document.getElementsByTagName('head')[0]
    var meta = document.createElement('meta')
    meta.name = 'referrer'
    meta.content = 'no-referrer'
    head.appendChild(meta)
    if (ispeak) {
        ispeak
            .init({
                el: '#ispeak',
                api: '<%- theme.speak.api %>',
                author: '<%- theme.speak.author %>',
                pageSize: '<%- theme.speak.pageSize %>',
                loading_img: '<%- theme.speak.loading_img %>'
            })
            .then(function () {
                document.getElementById('tip').style.display = 'none'
            })
    } else {
        document.getElementById('tip').innerHTML = '小声哔哔 依赖加载失败！'
    }
</script>
